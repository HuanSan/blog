(window.webpackJsonp=window.webpackJsonp||[]).push([[335],{620:function(t,a,s){"use strict";s.r(a);var e=s(10),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"p2p通信原理与实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#p2p通信原理与实现"}},[t._v("#")]),t._v(" P2P通信原理与实现")]),t._v(" "),a("h2",{attrs:{id:"_1、nat网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、nat网络"}},[t._v("#")]),t._v(" 1、NAT网络")]),t._v(" "),a("h3",{attrs:{id:"_1-1-防火墙-firewall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-防火墙-firewall"}},[t._v("#")]),t._v(" 1.1 防火墙（Firewall）")]),t._v(" "),a("p",[t._v("防火墙主要限制内网和公网的通讯，通常丢弃未经许可的数据包。防火墙会检测(但是不修改)试图进入内网数据包的IP地址和TCP/UDP端口信息。")]),t._v(" "),a("h3",{attrs:{id:"_1-2-nat工作原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-nat工作原理"}},[t._v("#")]),t._v(" 1.2 NAT工作原理")]),t._v(" "),a("p",[t._v("将IP数据报文中的IP地址转换为另一个IP地址的过程。当内部IP想要访问外网时，NAT主要实现内部网络和外部网络之间IP的转换，这种通过使用少量的公网IP地址代表较多的私网IP地址的方式，将有助于减缓可用IP地址空间的枯竭。")]),t._v(" "),a("h3",{attrs:{id:"_1-3-nat分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-nat分类"}},[t._v("#")]),t._v(" 1.3 NAT分类")]),t._v(" "),a("ol",[a("li",[t._v("基本NAT(Basic NAT)")])]),t._v(" "),a("p",[t._v("基本NAT会将内网主机的IP地址映射为一个公网IP，不改变其TCP/UDP端口号。基本NAT通常只有在当NAT有公网IP池的时候才有用。")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("网络地址-端口转换器(NAPT)")])]),t._v(" "),a("p",[t._v("到目前为止最常见的即为NAPT，其检测并修改出入数据包的IP地址和端口号，从而允许多个内网主机同时共享一个公网IP地址。")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Full Cone NAT(完全锥型)")]),t._v("\n在一个新会话建立了公网/内网端口绑定之后,完全圆锥形NAT接下来会接受对应公网端口的所有数据,无论是来自哪个（公网）终端. 完全圆锥形NAT有时候也被称为“混杂”NAT（promiscuous NAT）。")]),t._v(" "),a("li",[a("strong",[t._v("Address Restricted Cone NAT(地址限制锥型 )")]),t._v("\n地址限制圆锥形NAT只会转发符合某个条件的输入数据包. 条件为：外部（源）IP地址匹配内网主机之前发送一个或多个数据包的结点的IP地址，NAT通过限制输入数据包为一组“已知的”外部IP地址,有效地精简了防火墙的规则。")]),t._v(" "),a("li",[a("strong",[t._v("Port Restricted Cone NAT(端口限制锥型)")]),t._v("\n只当外部数据包的IP地址和端口号都匹配内网主机发送过的地址和端口号时才进行转发。端口限制圆锥型NAT为内部结点提供了和对称NAT相同等级的保护，以隔离未关联的数据。")]),t._v(" "),a("li",[a("strong",[t._v("Symmetric NAT(对称型)")]),t._v("\n不在所有公网-内网对的会话中维持一个固定的端口绑定，其为每个新的会话开辟一个新的端口。")])]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"NAT分类",href:"/blog/img/web/webrtc/2/1.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/1.png"),alt:"NAT分类"}})])]),t._v(" "),a("p",[t._v("部署在路由器上的NAT：")]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"NAT网络",href:"/blog/img/web/webrtc/2/2.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/2.png"),alt:"NAT网络"}})])]),t._v(" "),a("p",[a("strong",[t._v("NAT对比：")])]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"NAT对比",href:"/blog/img/web/webrtc/2/3.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/3.png"),alt:"NAT对比"}})])]),t._v(" "),a("p",[a("strong",[t._v("不同NAT之间打洞对比：")])]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"打洞对比",href:"/blog/img/web/webrtc/2/4.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/4.png"),alt:"打洞对比"}})])]),t._v(" "),a("h2",{attrs:{id:"_2、p2p通讯技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、p2p通讯技术"}},[t._v("#")]),t._v(" 2、P2P通讯技术")]),t._v(" "),a("p",[a("strong",[t._v("对等式网络")]),t._v("（英语：peer-to-peer， 简称"),a("strong",[t._v("P2P")]),t._v("），又称"),a("strong",[t._v("点对点技术")]),t._v("，是去中心化、依靠用户群（peers）交换信息的互联网体系，它的作用在于，减低以往网路传输中的节点，以降低资料遗失的风险。与有中心服务器的中央网络系统不同，对等网络的每个用户端既是一个节点，也有服务器的功能，任何一个节点无法直接找到其他节点，必须依靠其户群进行信息交流。")]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"对等网络",href:"/blog/img/web/webrtc/2/5.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/5.png"),alt:"对等网络"}})])]),t._v(" "),a("h3",{attrs:{id:"_2-1-p2p直接通讯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-p2p直接通讯"}},[t._v("#")]),t._v(" 2.1 P2P直接通讯")]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"局域网&公网",href:"/blog/img/web/webrtc/2/6.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/6.png"),alt:"局域网&公网"}})])]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"端口映射",href:"/blog/img/web/webrtc/2/7.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/7.png"),alt:"端口映射"}})])]),t._v(" "),a("h3",{attrs:{id:"_2-2-p2p穿透"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-p2p穿透"}},[t._v("#")]),t._v(" 2.2 P2P穿透")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("STUN/TURN方式")]),t._v("\nIETF定义的一种UDP穿透规范，最为普遍。")]),t._v(" "),a("li",[a("strong",[t._v("ICE")]),t._v("\n包括ALG,STUN,TURN等各种穿透方式的组合。")])]),t._v(" "),a("div",{staticClass:"img-page"},[a("a",{attrs:{"data-fancybox":"",title:"P2P",href:"/blog/img/web/webrtc/2/8.png"}},[a("img",{attrs:{src:t.$withBase("/img/web/webrtc/2/8.png"),alt:"P2P"}})])]),t._v(" "),a("h3",{attrs:{id:"_2-3-第三方p2p穿透"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-第三方p2p穿透"}},[t._v("#")]),t._v(" 2.3 第三方P2P穿透")]),t._v(" "),a("p",[t._v("花生壳内网穿透：优先打洞 -> 服务器转发(流量限制)")]),t._v(" "),a("h2",{attrs:{id:"_3、参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、参考"}},[t._v("#")]),t._v(" 3、参考")]),t._v(" "),a("p",[t._v("https://evilpan.com/2015/10/31/p2p-over-middle-box/")]),t._v(" "),a("p",[t._v("https://juejin.cn/post/6844904098572009485")]),t._v(" "),a("p",[t._v("https://developer.aliyun.com/article/243478")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/Vikanill/article/details/95023859")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/D3_3109/article/details/119875626")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/wgl307293845/article/details/120450626")]),t._v(" "),a("p",[t._v("https://zhuanlan.zhihu.com/p/299524798")]),t._v(" "),a("p",[t._v("https://zhuanlan.zhihu.com/p/108635427")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/lisemi/article/details/97672734")]),t._v(" "),a("p",[t._v("https://zhuanlan.zhihu.com/p/510428478")]),t._v(" "),a("p",[t._v("https://www.cdnbye.com/cn/views/")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/shaosunrise/article/details/83627828")]),t._v(" "),a("p",[t._v("https://zhuanlan.zhihu.com/p/468792680")]),t._v(" "),a("p",[t._v("https://zhuanlan.zhihu.com/p/71025431")])])}),[],!1,null,null,null);a.default=r.exports}}]);